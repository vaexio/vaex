import pytest


@pytest.mark.asyncio
async def test_async_execute(df):
    count_future = df.count(df.x, delay=True)
    await df.execute_async()
    assert await count_future == len(df)

